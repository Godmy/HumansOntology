# GraphQL Playground Руководство

## Обзор

GraphQL Playground (на основе GraphiQL) предоставляет интерактивный интерфейс для взаимодействия с GraphQL API. Он включает в себя редактор запросов, документацию к схеме и инструменты для отладки.

## Доступ к Playground

Playground доступен по адресу: [http://localhost:8000/graphql](http://localhost:8000/graphql)

## Настройки и конфигурация

### Переменные окружения

| Переменная | Значение по умолчанию | Описание |
|------------|----------------------|----------|
| `GRAPHQL_PLAYGROUND_ENABLED` | `true` | Включить/выключить GraphQL Playground |
| `GRAPHQL_PLAYGROUND_AUTH_REQUIRED` | `false` | Требовать аутентификацию для доступа к Playground |
| `GRAPHQL_PLAYGROUND_DEFAULT_HEADERS` | `{}` | JSON строка с заголовками по умолчанию для запросов |

Пример настройки заголовков по умолчанию в `.env` файле:
```
GRAPHQL_PLAYGROUND_DEFAULT_HEADERS={"Content-Type": "application/json", "X-API-Key": "your-api-key"}
```

## Основные функции

### 1. Интерактивная документация

- Кликните на кнопку "DOCS" справа для доступа к документации по схеме
- Наведите курсор на любое поле для получения описания
- Используйте поиск для быстрого нахождения типов и полей

Теперь документация схемы GraphQL значительно расширена. Все запросы, мутации, поля и их аргументы содержат подробные описания, примеры использования и информацию о необходимых правах доступа. Эти улучшения делают Playground более мощным инструментом для исследования и тестирования API, предоставляя всю необходимую информацию прямо в интерфейсе.

### 2. Примеры запросов

Для получения шаблонов часто используемых запросов перейдите по адресу:
[http://localhost:8000/graphql/examples](http://localhost:8000/graphql/examples)

Шаблоны включают в себя:
- Запросы для получения языков, концепций и переводов
- Мутации для создания и обновления данных
- Примеры с параметрами (variables)

### 3. Тестовый пользователь

Для упрощения разработки доступен endpoint для получения токена тестового пользователя:

**URL:** [http://localhost:8000/graphql/test-user-login](http://localhost:8000/graphql/test-user-login)

> ⚠️ Эта функция доступна только в development окружении

После получения токена добавьте его в HTTP заголовки в Playground:
```json
{
  "Authorization": "Bearer YOUR_ACCESS_TOKEN"
}
```

## Практическое использование

### Примеры запросов

#### 1. Получить все языки:
```graphql
query GetAllLanguages {
  languages {
    id
    name
    code
    is_active
  }
}
```

#### 2. Создать новую концепцию:
```graphql
mutation CreateConcept($input: CreateConceptInput!) {
  createConcept(input: $input) {
    id
    name
    description
    language {
      id
      name
    }
  }
}
```

**Variables:**
```json
{
  "input": {
    "name": "Тестовая концепция",
    "description": "Описание тестовой концепции",
    "languageId": "1"
  }
}
```

### Настройка HTTP заголовков

1. Внизу Playground нажмите на "HTTP HEADERS"
2. Добавьте заголовки в формате JSON:
```json
{
  "Authorization": "Bearer your-jwt-token",
  "Content-Type": "application/json"
}
```

## Безопасность

### Аутентификация

В production окружении рекомендуется включить аутентификацию для доступа к Playground:

```
GRAPHQL_PLAYGROUND_AUTH_REQUIRED=true
```

Тогда для доступа к Playground потребуется действительный JWT токен в заголовках.

### CORS настройки

- В development: все домены разрешены (`*`)
- В production: только указанные в `ALLOWED_ORIGINS` домены

## Отладка и логирование

### Запросы из Playground

Все запросы из GraphQL Playground помечаются специальными заголовками:
- `X-GraphQL-Client: Playground`
- `X-GraphQL-Request-Source: Playground`

Это позволяет идентифицировать и отслеживать такие запросы в логах и метриках.

### Логирование

Запросы из Playground логируются с меткой `graphql_playground_request`, что позволяет анализировать использование и отлаживать проблемы.

## Советы и рекомендации

1. **Храните часто используемые запросы** - используйте вкладки в Playground для хранения и быстрого доступа к часто используемым запросам

2. **Проверяйте документацию** - всегда сверяйтесь с документацией схемы для понимания доступных полей и типов

3. **Используйте переменные** - передавайте параметры через переменные, а не через hardcoded значения

4. **Проверяйте производительность** - следите за временем выполнения запросов и используйте фрагменты для оптимизации

5. **Тестируйте с аутентификацией** - используйте тестового пользователя или свой действительный токен для проверки защищенных запросов